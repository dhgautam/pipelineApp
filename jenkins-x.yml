buildPack: none
pipelineConfig:
  env:
    - name: DEPLOY_VAR
      value: bar
  pipelines:
    pullRequest:
      pipeline:
        agent:
          image: gcr.io/jenkinsxio/builder-go 
        stages:
        - name: release
          steps:
          - command: echo $DEPLOY_VAR
            dir: /workspace/source
            name: start-preview
          - command: ./pipeline.sh
            dir: /workspace/source
            name: run-preview
    release:
      pipeline:
        agent:
          image: gcr.io/jenkinsxio/builder-go
        stages:
        - name: release
          steps:
          - command: echo $DEPLOY_VAR
            dir: /workspace/source
            name: promote-staging
          - command: ./pipeline.sh
            dir: /workspace/source
            name: run-staging
